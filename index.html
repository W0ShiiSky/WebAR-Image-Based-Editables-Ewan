<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0" />
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>
    <link rel="stylesheet" type="text/css" href="./static/css/style.css" />
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
  </head>
  <body style="margin: 0; background-color: black;">
    <!-- id="UI-overlay" fixes the issue where the AR content gets cutoff at where the buttons are -->
    <!-- display flex is to prevent the UI overlay from disappearing when displaying AR content. Can be removed -->
    <div id="UI-overlay" style="max-height: 100%; max-width: 100%;">
      <div id="UI-placement">
        <!-- scanning box crosshair copied from MindAR example -->
        <div id="scanning-overlay" class="mindar-ui-scanning">
          <div class="scanning">
            <div class="inner" id="scanBoxSize">
              <div class="scanline"></div>
            </div>
          </div>
        </div>
        <div class="fortune-cookie" id="fortuneCookie">
          <div class="cookie-left" id="cookieLeft"></div>
          <div class="cookie-right" id="cookieRight"></div>
      </div>
      <div class="fortune-slip" id="fortuneSlip"></div>
      </div>

    </div>


    <a-scene mindar-image="imageTargetSrc: ./static/mind-file/Shinchan.mind; uiScanning: #scanning-overlay; filterMinCF:0.0001; filterBeta: 0.001;" color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false" embedded>

      <a-entity id="example-target" mindar-image-target="targetIndex: 0">  
        <a-gltf-model id="model" rotation="0 0 0 " position="0 -3 -9" scale="2 2 2" animation-mixer></a-gltf-model>

      </a-entity>

      <a-camera position="0 0 0" look-controls="enabled: false" cursor="fuse: false; rayOrigin: mouse;" raycaster="far: ${customFields.libVersion}; objects: .clickable"></a-camera>

    </a-scene>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const sceneEl = document.querySelector("a-scene");
        const modelEl = document.querySelector("#model");
        const exampleTarget = document.querySelector("#example-target");
        const modelInfoEl = document.getElementById("model-info");
        const fortunes = ["Success is on your horizon.",
                            "Good news will come to you by mail.",
                            "A pleasant surprise is waiting for you.",
                            "You will meet someone special soon.",
                            "Your hard work will pay off.",
                            "Adventure is in your future.",
                            "Happiness will come your way soon.",
                            "A lifetime of happiness lies ahead of you.",
                            "You will soon find the love of your life.",
                            "Financial prosperity is coming your way.",
                            "A new opportunity will present itself to you.",
                            "Your creative talents will be recognized and rewarded.",
                            "You will make lasting memories with friends and family.",
                            "Travel plans will bring you joy and excitement.",
                            "Unexpected blessings are coming your way.",
                            "You will overcome obstacles with ease.",
                            "An exciting adventure awaits you.",
                            "Your kindness will be repaid in unexpected ways.",
                            "You will achieve your goals with determination and perseverance.",
                            "A windfall of good fortune is heading your way."];


        // Listen for the mindar-target-detected event
        exampleTarget.addEventListener("targetFound", event => {
          console.log("Target detected:");
          console.log("Loading random model...");

          const randomFortune = fortunes[Math.floor(Math.random() * fortunes.length)];
          const fortuneSlip = document.getElementById('fortuneSlip');
          
          fortuneSlip.textContent = randomFortune;

          const fortuneCookie = document.getElementById('fortuneCookie');
          fortuneCookie.classList.add('cracked');
        });
      });
    </script>
  </body>
</html>